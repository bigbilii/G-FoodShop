<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>GFoofShop | 登录</title>
    <!-- Tell the browser to be responsive to screen width -->
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <!-- Bootstrap 3.3.7 -->
    <link href="https://cdn.bootcss.com/twitter-bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <!-- Theme style -->
    <link rel="stylesheet" href="../dist/css/AdminLTE.min.css">
    <!-- iCheck -->
    <link rel="stylesheet" href="../plugins/iCheck/square/blue.css">
    <!-- sweet alert -->
    <link rel="stylesheet" href="../plugins/sweetalert/sweetalert.css">

</head>

<body class="hold-transition login-page">
<div class="login-box">
    <div class="login-logo">
        <a href="../../index.html"><b>GFood</b>Shop</a>
    </div>
    <!-- /.login-logo -->
    <div class="login-box-body">
        <p class="login-box-msg">后台管理</p>

        <form action="#" onsubmit="return false;" method="post">
            <div class="form-group has-feedback">
                <input type="text" class="form-control" placeholder="手机号码" id="phone">
                <span class="glyphicon glyphicon-phone form-control-feedback"></span>
            </div>
            <div class="form-group has-feedback">
                <input type="password" class="form-control" placeholder="密码" id="password">
                <span class="glyphicon glyphicon-lock form-control-feedback"></span>
            </div>
            <div class="row">
                <div class="col-xs-8">
                    <div class="checkbox icheck">
                        <label>
                            <input type="checkbox" id="remenber"> 记住我
                        </label>
                    </div>
                </div>
                <!-- /.col -->
                <div class="col-xs-4">
                    <button type="submit" class="btn btn-primary btn-block btn-flat" onclick="login()">登录</button>
                </div>
                <!-- /.col -->
            </div>
        </form>
        <a href="">忘记密码</a><br>
        <a href="" class="text-center">立刻注册</a>

    </div>
    <!-- /.login-box-body -->
</div>
<!-- /.login-box -->

<!-- jQuery 3 -->
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<!-- Bootstrap 3.3.7 -->
<script src="https://cdn.bootcss.com/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
<!-- iCheck -->
<script src="../plugins/iCheck/icheck.min.js"></script>
<!-- sweet alert -->
<script src="../plugins/sweetalert/sweetalert.min.js"></script>

<script src="../dist/js/public.js"></script>
<script>
    $(function () {
        $('input').iCheck({
            checkboxClass: 'icheckbox_square-blue',
            radioClass: 'iradio_square-blue',
            increaseArea: '20%' /* optional */
        });
    });


    /**
     * 登录
     */
    function login() {
        var phone = $("#phone").val();
        var password = $("#password").val();
        var remenber = $("#remenber").prop("checked") === true;
        if (isNull(phone)) {
            swal("", "请输入手机号码!", "error");
            return;
        }
        if (!validPhone(phone)) {
            swal("", "请输入正确的手机号!", "error");
            return;
        }
        if (isNull(password)) {
            swal("", "请输入密码!", "error");
            return;
        }
        if (!validPassword(password)) {
            swal("", "请输入正确的密码!", "error");
            return;
        }
        var data = {"phone": phone, "password": password, "remember": remenber};
        $.ajax({
            type: "POST",//方法类型
            dataType: "json",//预期服务器返回的数据类型
            url: "/user/login",
            contentType: "application/json; charset=utf-8",
            data: JSON.stringify(data),
            success: function (result) {
                console.log(result);
                if (result.code === 200) {
                    $(location).prop('href', '/gfoodshop/pages/index.html');
                } else {
                    alert(result.message)
                    // swal("", ,result.message "error");
                }
            },
            error: function (result) {
                var resultMsg = result.responseJSON;
                swal("", resultMsg.message, "error");
            }
        });
    }
</script>
</body>

</html>